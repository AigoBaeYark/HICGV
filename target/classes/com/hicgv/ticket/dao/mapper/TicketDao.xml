<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

 <mapper namespace="com.hicgv.ticket.dao.TicketDao">
<!--	<select id="ticket" resultType="MoviesDto">
		SELECT * FROM HICGV_MOVIE ORDER BY TITLE_KOR
	</select> 
	
	<select id="biglocal" resultType="TheaterDto">
		SELECT * FROM HICGV_THEATER ORDER BY THEATER_ID
	</select> 
	
	<select id="local" resultType="TLocationDto">
		SELECT T.THEATER_ID, T.THEATER_LOC, TL.LOCATION_ID, TL.LOCATION_NAME 
		FROM HICGV_THEATER T INNER JOIN HICGV_THEATER_LOCATION TL 
		ON T.THEATER_ID =TL.THEATER_ID 
		ORDER BY T.THEATER_ID, TL.LOCATION_NAME 
		큰지역ID, 큰지역, 영화관ID, 영화관
	</select>
	
	<select id="time" resultType="TTimeDto"> 나중에 빼깅
		SELECT R.ROOM_NAME, R.MAX_SEAT, S.START_DATE 
		FROM HICGV_THEATER_ROOM R INNER JOIN HICGV_THEATER_SCHEDULE S 
		ON R.THEATER_ROOM_ID =S.THEATER_ROOM_ID 
		ORDER BY R.ROOM_NAME
		'n'관, 좌석수, 상영시간, 종료시간은 계산식을 구해서 진행 할 예정
	</select> 
	
	<select id="gettictime" resultType="TimeInfoDto"> 나중에 빼깅
      </select> -->
      
      <select id="ticket" resultType="MoviesDto">
		SELECT * FROM HICGV_MOVIE ORDER BY TITLE_KOR
		</select> 
	
      <!-- 여기수정 -->
      <!-- <select id="ticketmovie" resultType="TicketListDto">
       SELECT S.THEATER_SCHEDULE_ID, S.MOVIE_ID, M.TITLE_KOR, M.AGE_LIMIT, T.THEATER_ID ,T.THEATER_LOC, L.LOCATION_ID, L.LOCATION_NAME, SUBSTR(START_DATE, 9, 2) AS DAY, S.START_DATE, R.ROOM_NAME, SUBSTR(START_DATE, 12, 6) AS STARTTIME,M.RUNNING_TIME,M.RUNNING_TIME, R.MAX_SEAT 
	     FROM HICGV_THEATER_SCHEDULE S 
	      LEFT JOIN HICGV_THEATER_LOCATION L 
	     ON S.LOCATION_ID = L.LOCATION_ID 
	     LEFT JOIN HICGV_THEATER_ROOM R
	     ON S.THEATER_ROOM_ID = R.THEATER_ROOM_ID
	     LEFT JOIN HICGV_THEATER T 
	     ON L.THEATER_ID = T.THEATER_ID
	    LEFT JOIN HICGV_MOVIE M 
	     ON S.MOVIE_ID = M.MOVIE_ID
    	 WHERE S.MOVIE_ID = #{param1}
    	  ORDER BY M.TITLE_KOR 
      </select> -->
      
      <select id="tickettheater1" resultType="TicketListDto"> 
      	SELECT S.THEATER_SCHEDULE_ID, S.MOVIE_ID, M.TITLE_KOR, M.AGE_LIMIT, T.THEATER_ID ,T.THEATER_LOC, L.LOCATION_ID, L.LOCATION_NAME, SUBSTR(START_DATE, 9, 2) AS DAY, S.START_DATE, R.ROOM_NAME, SUBSTR(START_DATE, 12, 6) AS STARTTIME,M.RUNNING_TIME, R.MAX_SEAT 
	     FROM HICGV_THEATER_SCHEDULE S 
	      LEFT JOIN HICGV_THEATER_LOCATION L 
	     ON S.LOCATION_ID = L.LOCATION_ID 
	     LEFT JOIN HICGV_THEATER_ROOM R
	     ON S.THEATER_ROOM_ID = R.THEATER_ROOM_ID
	     LEFT JOIN  HICGV_THEATER T 
	     ON L.THEATER_ID = T.THEATER_ID
	    LEFT JOIN HICGV_MOVIE M 
	     ON S.MOVIE_ID = M.MOVIE_ID
    	 WHERE S.MOVIE_ID = #{param1} AND T.THEATER_ID=#{param2}
    	  ORDER BY L.LOCATION_ID 
      </select>
      
      <select id="tickettheater2" resultType="TicketListDto"> 
      	SELECT S.THEATER_SCHEDULE_ID, S.MOVIE_ID, M.TITLE_KOR, M.AGE_LIMIT, T.THEATER_ID ,T.THEATER_LOC, L.LOCATION_ID, L.LOCATION_NAME, SUBSTR(START_DATE, 9, 2) AS DAY, S.START_DATE, R.ROOM_NAME, SUBSTR(START_DATE, 12, 6) AS STARTTIME,M.RUNNING_TIME, R.MAX_SEAT 
      	FROM HICGV_THEATER_SCHEDULE S 
	      LEFT JOIN HICGV_THEATER_LOCATION L 
	     ON S.LOCATION_ID = L.LOCATION_ID 
	     LEFT JOIN HICGV_THEATER_ROOM R
	     ON S.THEATER_ROOM_ID = R.THEATER_ROOM_ID
	     LEFT JOIN  HICGV_THEATER T 
	     ON L.THEATER_ID = T.THEATER_ID
	    LEFT JOIN HICGV_MOVIE M 
	     ON S.MOVIE_ID = M.MOVIE_ID
    	 WHERE S.MOVIE_ID = #{param1} AND T.THEATER_ID=#{param2} AND L.LOCATION_ID=#{param3}
    	 ORDER BY S.START_DATE
      </select>
      
      <select id="ticketday" resultType="TicketListDto"> 
      	SELECT S.THEATER_SCHEDULE_ID, S.MOVIE_ID, M.TITLE_KOR, M.AGE_LIMIT, T.THEATER_ID ,T.THEATER_LOC, L.LOCATION_ID, L.LOCATION_NAME, SUBSTR(START_DATE, 9, 2) AS DAY, S.START_DATE, R.ROOM_NAME, SUBSTR(START_DATE, 12, 6) AS STARTTIME,M.RUNNING_TIME, R.MAX_SEAT 
	     FROM HICGV_THEATER_SCHEDULE S 
	      LEFT JOIN HICGV_THEATER_LOCATION L 
	     ON S.LOCATION_ID = L.LOCATION_ID 
	     LEFT JOIN HICGV_THEATER_ROOM R
	     ON S.THEATER_ROOM_ID = R.THEATER_ROOM_ID
	     LEFT JOIN  HICGV_THEATER T 
	     ON L.THEATER_ID = T.THEATER_ID
	    LEFT JOIN HICGV_MOVIE M 
	     ON S.MOVIE_ID = M.MOVIE_ID
    	WHERE S.MOVIE_ID = #{param1} AND T.THEATER_ID=#{param2} AND  L.LOCATION_ID=#{param3} AND SUBSTR(START_DATE, 9, 2)=#{param4}
      	ORDER BY S.START_DATE
      </select>
      
      <select id="tickettime" resultType="TicketListDto"> 
      	SELECT S.THEATER_SCHEDULE_ID, S.MOVIE_ID, M.TITLE_KOR, M.AGE_LIMIT, T.THEATER_ID ,T.THEATER_LOC, L.LOCATION_ID, L.LOCATION_NAME, SUBSTR(START_DATE, 9, 2) AS DAY, S.START_DATE, R.ROOM_NAME, SUBSTR(START_DATE, 12, 6) AS STARTTIME,M.RUNNING_TIME, R.MAX_SEAT 
	     FROM HICGV_THEATER_SCHEDULE S 
	      LEFT JOIN HICGV_THEATER_LOCATION L 
	     ON S.LOCATION_ID = L.LOCATION_ID 
	     LEFT JOIN HICGV_THEATER_ROOM R
	     ON S.THEATER_ROOM_ID = R.THEATER_ROOM_ID
	     LEFT JOIN  HICGV_THEATER T 
	     ON L.THEATER_ID = T.THEATER_ID
	    LEFT JOIN HICGV_MOVIE M 
	     ON S.MOVIE_ID = M.MOVIE_ID
    	WHERE S.MOVIE_ID = #{param1} AND T.THEATER_ID=#{param2} AND  L.LOCATION_ID=#{param3} AND SUBSTR(START_DATE, 9, 2)=#{param4} AND SUBSTR(START_DATE, 12, 6)=#{param5}
      	ORDER BY S.START_DATE
      	</select>
      
      
      
      
      
      
      
      
      
      
      
      
	
</mapper> 
 